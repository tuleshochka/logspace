# Тестовое задание к интенсиву "Как поднять тестирование проекта с нуля?"
## Как запустить
Файл **create_data.py** поможет создать таблицу в ранее созданной базе данных и занести в нее 2_000_000 строк. Количество строк можно поменять, указав другое число в качестве аргумента для функции **create_data**.

В папке **tests** содержатся файлы с функциональными и перфоманс тестами. Для изменения шаблона для запроса `SELECT * FROM ttable WHERE str LIKE %s` необходимо поменять переменную **pattern**.

Для запуска всех функциональных тестов необходимо выполнить в терминале команду:
```bash
pytest .\tests\test_functional.py -v
```
Для запуска всех перфоманс тестов:
```bash
pytest .\tests\test_perfomance.py -v --benchmark-compare
```

## Мини-отчет
Создана база данных под названием "logspace".
```sql
CREATE DATABASE `logspace`
```
Создана таблица "ttable".
```sql
CREATE TABLE IF NOT EXISTS ttable (
  id int NOT NULL AUTO_INCREMENT,
  date date NOT NULL,
  str varchar(255) NOT NULL,
  PRIMARY KEY (id)
  )
```
В базу данных записано 2_000_000 строк с помощью библиотеки **faker**.

### Функциональные тесты
Написано три **функциональных** теста:
* Проверка на совпадение количества найденных строк из кода на Python и из SQL Editor в MySQL Workbench на неидексированных данных.
* Проверка на совпадение количества найденных строк из кода на Python и из SQL Editor в MySQL Workbench на индексированных данных.
* Проверка на одинаковое количество найденных строк для индексированных данных и неиндексированных.

Для первых двух тестов сначала был выполнен следующий запрос в Workbench:
```sql
SELECT COUNT(*) FROM logspace.ttable WHERE str LIKE 'Take%'
```
Затем результат запроса был внесен в код, как правильный исход теста.

Результат выполнения **функциональных** тестов:
![image](https://github.com/tuleshochka/logspace/assets/75882629/f588a33b-143a-4062-a403-fbf71da5f9a5)

### Перфоманс тесты
* Тест на время выполнения запроса для неиндексированных данных.
* Тест на время выполнения запроса для индексированных данных.

Результат выполнения **перфоманс** тестов для шаблона `Take%`:
![image](https://github.com/tuleshochka/logspace/assets/75882629/ccb424aa-2e1a-4709-81d0-6f49b522f3a1)
Видно, что на индексированных данных запрос работает гораздо быстрее.

### Случай, когда индекс не будет использоваться
Индекс не влияет на скорость выполнения запроса в случае, когда шаблон имеет вид `%str%` или %str`. На скриншоте это видно:
![Для int-1](https://github.com/tuleshochka/logspace/assets/75882629/7d461303-a398-436c-b5c2-87faa99f5e0d)
